!function(exports){"use strict";function $(expr,con){return"string"==typeof expr?(con||document).querySelector(expr):expr||null}function $$(expr,con){return Array.prototype.slice.call((con||document).querySelectorAll(expr))}$.bind=function(elements,o){elements&&(elements=elements.length?elements:[elements],elements.forEach(function(element){for(var event in o){var callback=o[event];event.split(/\s+/).forEach(function(event){element.addEventListener(event,callback)})}}))};var defaultOptions={disableHistory:!1,swipe:!0,classNames:{link:"perfundo__link",overlay:"perfundo__overlay",content:"perfundo__content",close:"perfundo__close",prev:"perfundo__prev",next:"perfundo__next",untarget:"perfundo__untarget",active:"is-active"}},Perfundo=function(element,options){void 0===options&&(options={});var me=this;if(this.element=$(element),this.options=options,!this.element)return{};if(this._configure(defaultOptions),$.bind($$("."+this.options.classNames.link,this.element),{click:function(e){me.options.disableHistory&&e.preventDefault(),me.open(this.getAttribute("href"))}}),$.bind(this.element,{click:function(e){(e.target.classList.contains(me.options.classNames.close)||e.target.classList.contains(me.options.classNames.overlay))&&(me.options.disableHistory&&e.preventDefault(),me.close())}}),this.options.swipe){var swipeDistanceX,swipeDistanceY,touchStartX=0,touchStartY=0,touchEndX=0,touchEndY=0,swipeMinX=50,swipeMaxY=60;$.bind($$("."+this.options.classNames.content,this.element),{touchstart:function(e){touchStartX=e.changedTouches[0].clientX,touchStartY=e.changedTouches[0].clientY},touchend:function(e){touchEndX=e.changedTouches[0].clientX,touchEndY=e.changedTouches[0].clientY,swipeDistanceX=touchStartX-touchEndX,swipeDistanceY=touchStartY-touchEndY,Math.abs(swipeDistanceX)>=swipeMinX&&Math.abs(swipeDistanceY)<=swipeMaxY&&(swipeDistanceX>swipeMinX?me.next():me.prev()),touchStartX=0,touchStartY=0,touchEndX=0,touchEndY=0,swipeDistanceX=null,swipeDistanceY=null}})}};Perfundo.prototype.open=function(overlayItem){overlayItem=$(overlayItem),this.close(),overlayItem.classList.add(this.options.classNames.active)},Perfundo.prototype.close=function(){var this$1=this;$$("."+this.options.classNames.overlay+"."+this.options.classNames.active,this.element).forEach(function(overlayItem){overlayItem.classList.remove(this$1.options.classNames.active)})},Perfundo.prototype.next=function(){var nextLink=$("."+this.options.classNames.next,this.element);nextLink&&nextLink.click()},Perfundo.prototype.prev=function(){var prevLink=$("."+this.options.classNames.prev,this.element);prevLink&&prevLink.click()},Perfundo.prototype._configure=function(defaultOptions){var this$1=this;for(var i in defaultOptions){var initial=defaultOptions[i],attrValue=this$1.element.getAttribute("data-"+i.toLowerCase());"number"==typeof initial?this$1.options[i]=parseInt(attrValue):initial instanceof Function?this$1.options[i]=null:attrValue&&(this$1.options[i]=attrValue),this$1.options[i]||0===this$1.options[i]||(this$1.options[i]=i in this$1.options?this$1.options[i]:initial)}},exports.Perfundo=Perfundo}(this.Perfundo=this.Perfundo||{});