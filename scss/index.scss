// @TODO: use sane variable names.
$perfundo-namespace:        'perfundo' !default;
$perfundo-background-color: #000 !default;
$perfundo-opacity:          0.9 !default;
$perfundo-svg-buttons:      false !default;

/**
 * 1. Make the overlay full width and height.
 * 2. Center direct children both horizontally and vertically.
 * 3. Hide the overlay by default and show it when it is targeted or active.
 */
.#{$perfundo-namespace}__overlay {
  position: fixed; /* [1] */
  top: 0; /* [1] */
  right: 0; /* [1] */
  bottom: 0; /* [1] */
  left: 0; /* [1] */
  display: flex; /* [2] */
  visibility: hidden; /* [3] */
  justify-content: center; /* [2] */
  align-items: center; /* [2] */
  background-color: rgba($perfundo-background-color, $perfundo-opacity);
  &:target,
  &.is-active {
    visibility: visible; /* [3] */
  }
}

/**
 * 1. Add a scrollbar if the content doesn't fit vertically.
 * 2. Inherit the animation name (e.g. animate.css class) from the parent.
 */
.#{$perfundo-namespace}__content {
  overflow: auto; /* [1] */
  max-height: 100%; /* [1] */
  :target > &,
  .is-active > & {
    animation: 0.4s ease-out 0.2s both;
    animation-name: inherit; /* [2] */
  }
}

.#{$perfundo-namespace}__html {
  padding: 2em; // @TODO: make configurable.
  max-width: 42em; // @TODO: make configurable.
  background: #fff; // @TODO: make configurable.
}

/**
 * 1. Prevent the full sized image from loading initially.
 * 2. Trigger loading of the full sized image when the lightbox is opened.
 */
.#{$perfundo-namespace}__figure {
  display: none; /* [1] */
  margin: map-get($spacing, m);
  :target > &,
  .is-active > & {
    display: block; /* [2] */
  }
  img {
    display: none; // @TODO: remove from here and html or test what makes sense for a11n.
  }
}

.#{$perfundo-namespace}__figcaption {
  color: #efefef; // @TODO: make configurable.
}

/**
 * 1. Make the image container responsive.
 * 2. Scale the background image to match the size of the image container.
 */
.#{$perfundo-namespace}__image {
  max-width: 100%; /* [1] */
  background-size: 100%; /* [2] */
}

/**
 * 1. Make the icons as big as the control element.
 * 2. Hide the control text visually, but have it available for screen readers.
 * 3. Make the control links readable depending on the overlay color.
 */
.#{$perfundo-namespace}__control {
  position: absolute;
  @if $perfundo-svg-buttons {
    width: 3em;
    height: 3em;
    background-position: center center; /* [1] */
    background-size: cover; /* [1] */
    text-indent: -999em; /* [2] */
  } @else {
    &,
    &:visited {
      color: #fff; /* [3] */ // @TODO: make configurable.
    }
  }
}

.#{$perfundo-namespace}__close {
  top: map-get($spacing, s);
  right: map-get($spacing, s);
  @if $perfundo-svg-buttons {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" version%3D"1.1" x%3D"0" y%3D"0" viewBox%3D"0 0 32 32" xml%3Aspace%3D"preserve"><path fill%3D"%23fff" d%3D"M21.7 10.3c-0.4-0.4-1-0.4-1.4 0l-4.3 4.3-4.2-4.2c-0.4-0.4-1-0.4-1.4 0-0.4 0.4-0.4 1 0 1.4l4.2 4.2-4.3 4.3c-0.4 0.4-0.4 1 0 1.4 0.4 0.4 1 0.4 1.4 0l4.3-4.3 4.2 4.2c0.4 0.4 1 0.4 1.4 0 0.4-0.4 0.4-1 0-1.4l-4.2-4.2 4.3-4.3C22.1 11.3 22.1 10.7 21.7 10.3zM16 0C7.2 0 0 7.2 0 16s7.2 16 16 16c8.8 0 16-7.2 16-16S24.8 0 16 0zM16 30C8.3 30 2 23.7 2 16S8.3 2 16 2s14 6.3 14 14S23.7 30 16 30z"%2F><%2Fsvg>');
  }
}

.#{$perfundo-namespace}__prev,
.#{$perfundo-namespace}__next {
  top: 50%;
  margin-top: -1.5em;
  opacity: 0.2;
  transition: opacity 0.2s;
  @if $perfundo-svg-buttons {
    background-image: url('data:image/svg+xml;utf8,<svg xmlns%3D"http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" version%3D"1.1" x%3D"0" y%3D"0" width%3D"44.1" height%3D"94.7" viewBox%3D"0 0 44.1 94.7" enable-background%3D"new 0 0 44.088 94.67" xml%3Aspace%3D"preserve"><path fill%3D"%23fff" d%3D"M44.1 47.3L1.5 94.7 0 93.3l41.4-46L0 1.3 1.5 0 44.1 47.3z"%2F><%2Fsvg>');
  }
  &:hover,
  &:focus {
    opacity: 1;
  }
}

.#{$perfundo-namespace}__prev {
  left: map-get($spacing, l);
  @if $perfundo-svg-buttons {
    transform: rotate(180deg);
  }
}

.#{$perfundo-namespace}__next {
  right: map-get($spacing, l);
}

/**
 * 1. Move the untarget anchor to the top of the screen to prevent "jumping".
 */
.#{$perfundo-namespace}__untarget {
  position: fixed; /* [1] */
  top: 0; /* [1] */
}
